# Implementation Plan: Edit Contributions

**Branch**: `002-edit-contributions` | **Date**: 2025-12-22 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/002-edit-contributions/spec.md`

## Summary

Add ability to edit and delete contributions on the contributions page. Users can click edit/delete actions on any contribution row. Edit opens a pre-populated form modal; delete shows a confirmation dialog. Slice calculations update automatically on save.

## Technical Context

**Language/Version**: TypeScript 5.x (strict mode)
**Framework**: Next.js 16.x (App Router) + React 19
**Primary Dependencies**: React Context, existing ContributionForm component
**Storage**: localStorage via existing useLocalStorage hook
**Styling**: Tailwind CSS 4.x
**Testing**: Vitest + React Testing Library
**Target Platform**: Web (responsive: mobile, tablet, desktop)
**Project Type**: Web application (client-side only)
**Performance Goals**: Slice recalculation < 1 second
**Constraints**: Offline-capable, no backend dependencies
**Scale/Scope**: Single-user local application

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Local-First Architecture | PASS | Uses existing localStorage persistence |
| II. Reusable Infrastructure | PASS | Extends existing ContributionForm, uses existing hooks |
| III. Responsive Design | PASS | Modal and table actions work across breakpoints |
| IV. Export System | N/A | Not affected by this feature |
| V. Simplicity Over Features | PASS | No new libraries, extends existing patterns |
| VI. Technology Stack | PASS | Uses approved technologies only |

**Result**: All gates pass. No violations to justify.

## Project Structure

### Documentation (this feature)

```text
specs/002-edit-contributions/
├── plan.md              # This file
├── spec.md              # Feature specification
├── checklists/          # Validation checklists
└── tasks.md             # Task breakdown (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/
├── app/
│   └── contributions/
│       └── page.tsx           # MODIFY: Add edit/delete handlers, delete modal
├── components/
│   └── slicing-pie/
│       ├── ContributionForm.tsx    # MODIFY: Support edit mode with pre-populated data
│       └── ContributionRow.tsx     # MODIFY: Add edit/delete action buttons
├── context/
│   └── SlicingPieContext.tsx  # MODIFY: Add updateContribution, removeContribution
├── hooks/
│   └── useSlicingPie.ts       # Already has update/remove logic if needed
└── types/
    └── slicingPie.ts          # No changes needed
```

**Structure Decision**: Existing Next.js App Router structure. All changes extend existing files; no new files required.

## Implementation Approach

### Phase 1: Context Layer
1. Add `updateContribution(id, data)` method to SlicingPieContext
2. Add `removeContribution(id)` method to SlicingPieContext
3. Both methods persist to localStorage and trigger re-render

### Phase 2: ContributionForm Enhancement
1. Add optional `contribution` prop for edit mode
2. Pre-populate form when `contribution` is provided
3. Show contributor name (read-only) instead of contributor dropdown in edit mode
4. Change submit button text to "Save Changes" in edit mode

### Phase 3: ContributionRow Actions
1. Add Edit and Delete icon buttons to each row
2. Edit button triggers `onEdit(contributionId)` callback
3. Delete button triggers `onDelete(contributionId)` callback

### Phase 4: Contributions Page Integration
1. Add state for `editingContribution` and `deleteConfirmId`
2. Wire up edit handler to open ContributionForm with contribution data
3. Wire up delete handler to show confirmation modal
4. Add delete confirmation modal with cancel/confirm actions

## Complexity Tracking

> No violations to justify. Implementation uses existing patterns.

| Item | Approach | Rationale |
|------|----------|-----------|
| Edit form | Reuse ContributionForm | Avoids duplication, maintains consistency |
| Delete confirmation | Reuse Modal component | Existing pattern from ContributorsPage |
| State management | React Context | Constitution requires, already in use |
